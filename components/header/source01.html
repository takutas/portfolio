<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="utf-8">
	<meta name="format-detection" content="telephone=no,address=no,email=no">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<title>Header1 Components Takumi Tanigawa Portfolio</title>
	<link href="/portfolio/assets/css/style.min.css" media="all" rel="stylesheet">
	<style>
		body.open {
			overflow: hidden;
		}

		.header {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 60px;
			display: flex;
			align-items: center;
			background-color: #FFF;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
		}

		.header__menu-button {
			display: none;
		}

		@media screen and (max-width: 767px) {
			.header__menu-button {
				background-color: #8e919b;
				display: block;
				width: 65px;
				height: 65px;
				z-index: 5;
				cursor: pointer;
				position: fixed;
				top: 0;
				right: 0;
			}
		}

		#wrap-all.open .header__menu-button {
			position: fixed;
			background: transparent;
		}

		.header__menu-icon-line {
			background: #FFF;
			display: inline-block;
			width: 29px;
			height: 1px;
			position: absolute;
			top: 50%;
			left: 18px;
		}

		@media screen and (max-width: 767px) {
			.header__menu-icon-line {
				width: 2.9rem;
				height: 0.1rem;
				left: 1.8rem;
			}
		}

		.header__menu-icon-line:nth-of-type(1) {
			transform: translateY(-7px);
		}

		@media screen and (max-width: 767px) {
			.header__menu-icon-line:nth-of-type(1) {
				transform: translateY(-0.7rem);
			}
		}

		.header__menu-icon-line:nth-of-type(3) {
			transform: translateY(7px);
		}

		@media screen and (max-width: 767px) {
			.header__menu-icon-line:nth-of-type(3) {
				transform: translateY(0.7rem);
			}
		}

		#wrap-all.open .header__menu-icon-line:nth-of-type(1) {
			transform: rotate(45deg);
		}

		#wrap-all.open .header__menu-icon-line:nth-of-type(2) {
			display: none;
		}

		#wrap-all.open .header__menu-icon-line:nth-of-type(3) {
			transform: rotate(-45deg);
		}

		.header__drawer {
			display: contents;
		}

		@media screen and (max-width: 767px) {
			.header__drawer {
				display: block;
				background-color: #8e919b;
				position: absolute;
				top: 0;
				left: 0px;
				width: 100%;
				height: 0px;
				visibility: hidden;
				overflow: hidden;
				transition: height 0.4s, visibility 0.4s;
			}
		}

		#wrap-all.open .header__drawer {
			height: 100dvh;
			pointer-events: auto;
			visibility: visible;
		}

		.header__drawer-inner {
			display: contents;
		}

		@media screen and (max-width: 767px) {
			.header__drawer-inner {
				display: block;
				height: 100%;
				padding: 80px 0;
				overflow: hidden;
				overflow-y: scroll;
				-webkit-overflow-scrolling: touch;
				overflow-scrolling: touch;
				-ms-overflow-style: none;
				scrollbar-width: none;
			}
		}

		.header__nav {
			flex: 1;
		}

		.header__nav-list {
			display: flex;
			justify-content: center;
			gap: 24px;
		}

		@media screen and (max-width: 767px) {
			.header__nav-list {
				flex-direction: column;
				gap: 0;
				border-top: 1px solid #686d80;
			}
		}

		@media screen and (max-width: 767px) {
			.header__nav-item {
				border-bottom: 1px solid #686d80;
			}
		}

		.header__nav-item>a {
			display: block;
			font-size: 14px;
		}

		@media screen and (max-width: 767px) {
			.header__nav-item>a {
				padding: 16px;
			}
		}

		.header__nav-item>a:hover {
			opacity: 0.7;
		}

		.header__nav-button {
			position: relative;
			padding-right: 20px;
			cursor: pointer;
			font-size: 14px;
			display: block;
			width: 100%;
			text-align: left;
			color: #000;
		}

		@media screen and (max-width: 767px) {
			.header__nav-button {
				padding: 16px;
			}
		}

		.header__nav-button::after {
			content: "▾";
			position: absolute;
			right: 6px;
			top: 50%;
			transform: translateY(-50%);
			pointer-events: none;
		}

		.header__nav-child {
			position: absolute;
			top: 100%;
			left: 0;
			width: 100%;
			height: 0;
			background-color: #aaacb5;
			visibility: hidden;
			overflow: hidden;
			transition: height 0.4s, visibility 0.4s;
		}

		@media screen and (max-width: 767px) {
			.header__nav-child {
				position: unset;
			}
		}

		.header__nav-item--parent.active .header__nav-child {
			visibility: visible;
		}

		.header__nav-sublist {
			display: flex;
			gap: 24px;
			max-width: 800px;
			margin: 0 auto;
			padding: 24px;
		}

		@media screen and (max-width: 767px) {
			.header__nav-sublist {
				flex-direction: column;
				align-items: center;
				padding: 40px;
			}
		}

		.header__nav-subitem {
			flex: 1;
			max-width: 500px;
		}

		.header__nav-subitem a img {
			width: 100%;
			aspect-ratio: 16/9;
			background-color: #FFF;
			margin-bottom: 8px;
		}

		.header__nav #js-focus-trap {
			display: none;
		}

		@media screen and (max-width: 767px) {
			.header__nav #js-focus-trap {
				display: block;
			}
		}
	</style>
</head>

<body>
	<div id="wrap-all">
		<header class="header">
			<button class="header__menu-button" id="btn-menu" aria-label="メニューを開く" aria-controls="header-navigation"
				aria-expanded="false">
				<span class="header__menu-icon-line"></span>
				<span class="header__menu-icon-line"></span>
				<span class="header__menu-icon-line"></span>
			</button>

			<div class="header__drawer">
				<div class="header__drawer-inner">
					<nav class="header__nav" id="header-navigation">
						<ul class="header__nav-list">
							<li class="header__nav-item"><a class="header__nav-link" href="#">UNDER1</a></li>
							<li class="header__nav-item"><a class="header__nav-link" href="#">UNDER2</a></li>

							<li class="header__nav-item header__nav-item--parent">
								<button class="header__nav-button" aria-label="メニューを開く" aria-controls="nav-child01"
									aria-expanded="false">UNDER3</button>
								<div class="header__nav-child" id="nav-child01">
									<ul class="header__nav-sublist">
										<li class="header__nav-subitem">
											<a class="header__nav-sublink" href="#">
												<img src="../image/sample_16-9.svg" alt="">
												UNDER3-1
											</a>
										</li>
										<li class="header__nav-subitem">
											<a class="header__nav-sublink" href="#">
												<img src="../image/sample_16-9.svg" alt="">
												UNDER3-2
											</a>
										</li>
										<li class="header__nav-subitem">
											<a class="header__nav-sublink" href="#">
												<img src="../image/sample_16-9.svg" alt="">
												UNDER3-3
											</a>
										</li>
									</ul>
								</div>
							</li>

							<li class="header__nav-item header__nav-item--parent">
								<button class="header__nav-button" aria-label="メニューを開く" aria-controls="nav-child02"
									aria-expanded="false">UNDER4</button>
								<div class="header__nav-child" id="nav-child02">
									<ul class="header__nav-sublist">
										<li class="header__nav-subitem">
											<a class="header__nav-sublink" href="#">
												<img src="../image/sample_16-9.svg" alt="">
												UNDER4-1
											</a>
										</li>
										<li class="header__nav-subitem">
											<a class="header__nav-sublink" href="#">
												<img src="../image/sample_16-9.svg" alt="">
												UNDER4-2
											</a>
										</li>
										<li class="header__nav-subitem">
											<a class="header__nav-sublink" href="#">
												<img src="../image/sample_16-9.svg" alt="">
												UNDER4-3
											</a>
										</li>
										<li class="header__nav-subitem">
											<a class="header__nav-sublink" href="#">
												<img src="../image/sample_16-9.svg" alt="">
												UNDER4-3
											</a>
										</li>
									</ul>
								</div>
							</li>
						</ul>
						<div id="js-focus-trap" tabindex="-1"></div>
					</nav>
				</div>
			</div>
		</header>
		<div style="height: 100dvh;"></div>
	</div>

	<script>
		document.addEventListener('DOMContentLoaded', () => {
			let state = false;
			let pos = 0;

			const btnMenu = document.getElementById('btn-menu');
			const wrapAll = document.getElementById('wrap-all');
			const body = document.body;
			const focusTrap = document.getElementById('js-focus-trap');

			// メニューボタン押下時
			btnMenu.addEventListener('click', () => {
				if (!state) {
					pos = window.scrollY || window.pageYOffset;
					wrapAll.classList.add('open');
					body.classList.add('open');
					btnMenu.setAttribute("aria-expanded", "true");
					btnMenu.setAttribute("aria-label", "メニューを閉じる");
					focusTrap.setAttribute("tabindex", "0");
					state = true;
				} else {
					wrapAll.classList.remove('open');
					body.classList.remove('open');
					btnMenu.setAttribute("aria-expanded", "false");
					btnMenu.setAttribute("aria-label", "メニューを開く");
					focusTrap.setAttribute("tabindex", "-1");
					state = false;
				}
			});

			// フォーカストラップ
			focusTrap.addEventListener('focus', () => {
				btnMenu.focus();
			});

			// ESCキーでメニューを閉じる
			window.addEventListener('keyup', (e) => {
				if (e.key === 'Escape' || e.keyCode === 27) {
					if (state) {
						wrapAll.classList.remove('open');
						body.classList.remove('open');
						btnMenu.setAttribute("aria-expanded", "false");
						btnMenu.setAttribute("aria-label", "メニューを開く");
						focusTrap.setAttribute("tabindex", "-1");
						state = false;
						window.scrollTo(0, pos);
					}
				}
			});
		});

		//メガメニュー
		document.addEventListener('DOMContentLoaded', function () {
			const parentItems = document.querySelectorAll('.header__nav-item--parent');
			const parentButtons = document.querySelectorAll('.header__nav-button');

			// 子メニューの高さを取得（ulを対象）
			const getSublistHeight = (button) => {
				const child = button.nextElementSibling;
				const sublist = child?.querySelector('ul');
				return sublist ? sublist.offsetHeight : 0;
			};

			parentButtons.forEach(button => {
				// マウス or フォーカス時に高さを計算しておく
				['mouseenter', 'focus'].forEach(evt => {
					button.addEventListener(evt, () => {
						const height = getSublistHeight(button);
						button.dataset.childHeight = height;
					});
				});

				button.addEventListener('click', (e) => {
					e.preventDefault();
					const currentParent = button.closest('.header__nav-item--parent');
					const child = button.nextElementSibling;

					// 全ての親メニューを閉じる
					parentItems.forEach(item => {
						item.classList.remove('active');
						const childEl = item.querySelector('ul')?.parentElement;
						if (childEl) childEl.style.height = '';
					});

					// 開閉の切り替え
					const isOpen = button.getAttribute('aria-expanded') === 'true';
					parentButtons.forEach(btn => {
						btn.setAttribute('aria-expanded', 'false');
						btn.setAttribute('aria-label', 'メニューを開く');
					});

					if (isOpen) {
						// すでに開いていたら閉じるだけで終了
						return;
					}

					// 開く
					currentParent.classList.add('active');
					const height = button.dataset.childHeight || getSublistHeight(button);
					if (child) child.style.height = `${height}px`;
					button.setAttribute('aria-expanded', 'true');
					button.setAttribute('aria-label', 'メニューを閉じる');
				});
			});

			// 領域外クリックで全て閉じる
			document.addEventListener('click', (e) => {
				if (!e.target.closest('.header__nav-item--parent')) {
					parentItems.forEach(item => {
						item.classList.remove('active');
						const child = item.querySelector('ul')?.parentElement;
						if (child) child.style.height = '';
						const btn = item.querySelector('button');
						if (btn) {
							btn.setAttribute('aria-expanded', 'false');
							btn.setAttribute('aria-label', 'メニューを開く');
						}
					});
				}
			});
		});
	</script>
</body>

</html>